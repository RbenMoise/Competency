{"ast":null,"code":"import _objectSpread from\"/Volumes/Rben/Repos/Spider_chart/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from\"react\";import axios from\"axios\";import InputForm from\"./ScoreInput\";import\"./ScoreInput.css\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function ScoreFormManager(_ref){let{categories,onScoresChange,initialScores}=_ref;const[currentScores,setCurrentScores]=useState((initialScores===null||initialScores===void 0?void 0:initialScores.currentScores)||Object.fromEntries(categories.map(cat=>[cat,0])));const[projectedScores,setProjectedScores]=useState((initialScores===null||initialScores===void 0?void 0:initialScores.projectedScores)||Object.fromEntries(categories.map(cat=>[cat,0])));const[sending,setSending]=useState(false);const[message,setMessage]=useState(\"\");// Call onScoresChange when initialScores or scores change\nuseEffect(()=>{if(initialScores){onScoresChange({currentScores,projectedScores});}},[initialScores,currentScores,projectedScores,onScoresChange]);const handleScoreChange=setter=>e=>{const{name,value}=e.target;const val=Math.min(5,Math.max(0,parseInt(value)||0));setter(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:val}));};const handleSendScores=async()=>{setSending(true);setMessage(\"\");const isValidScore=val=>typeof val===\"number\"&&!isNaN(val)&&val>0&&val<=5;const allCurrentFilled=Object.values(currentScores).every(isValidScore);const allProjectedFilled=Object.values(projectedScores).every(isValidScore);if(!allCurrentFilled||!allProjectedFilled){setMessage(\"âš ï¸ Please fill in all fields with scores between 1 and 5.\");setSending(false);return;}try{const response=await axios.post(\"http://localhost:4000/api/scores\",{current:currentScores,projected:projectedScores},{withCredentials:true});if(response.status===201){setMessage(\"âœ… Scores submitted successfully!\");onScoresChange({currentScores,projectedScores});}else{setMessage(\"âš ï¸ Something went wrong. Please try again.\");}}catch(error){var _error$response,_error$response2;console.error(\"Error submitting scores:\",(_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.data);const status=(_error$response2=error.response)===null||_error$response2===void 0?void 0:_error$response2.status;if(status===409){setMessage(\"âœ… Scores already submitted. Displaying your chart...\");onScoresChange({currentScores,projectedScores});}else{setMessage(status===403?\"ðŸš« Session expired. Please log in again.\":\"âŒ Error submitting scores. Try again.\");if(status===403){window.location.href=\"/login\";}}}finally{setSending(false);}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(InputForm,{title:\"CURRENT STATE (JUNE 2025)\",scores:currentScores,onChange:handleScoreChange(setCurrentScores),categories:categories}),/*#__PURE__*/_jsx(InputForm,{title:\"TARGET FOR 2027\",scores:projectedScores,onChange:handleScoreChange(setProjectedScores),categories:categories}),/*#__PURE__*/_jsxs(\"div\",{className:\"submit-section\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"modern-button send-btn\",onClick:handleSendScores,disabled:sending,children:sending?\"Sending...\":\"Submit Assessment\"}),message&&/*#__PURE__*/_jsx(\"p\",{className:\"status-message\",children:message})]})]});}","map":{"version":3,"names":["React","useState","useEffect","axios","InputForm","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ScoreFormManager","_ref","categories","onScoresChange","initialScores","currentScores","setCurrentScores","Object","fromEntries","map","cat","projectedScores","setProjectedScores","sending","setSending","message","setMessage","handleScoreChange","setter","e","name","value","target","val","Math","min","max","parseInt","prev","_objectSpread","handleSendScores","isValidScore","isNaN","allCurrentFilled","values","every","allProjectedFilled","response","post","current","projected","withCredentials","status","error","_error$response","_error$response2","console","data","window","location","href","children","title","scores","onChange","className","onClick","disabled"],"sources":["/Volumes/Rben/Repos/Spider_chart/frontend/src/components/ScoreInput/ScoreFormManager.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport InputForm from \"./ScoreInput\";\nimport \"./ScoreInput.css\";\n\nexport default function ScoreFormManager({\n  categories,\n  onScoresChange,\n  initialScores,\n}) {\n  const [currentScores, setCurrentScores] = useState(\n    initialScores?.currentScores ||\n      Object.fromEntries(categories.map((cat) => [cat, 0]))\n  );\n  const [projectedScores, setProjectedScores] = useState(\n    initialScores?.projectedScores ||\n      Object.fromEntries(categories.map((cat) => [cat, 0]))\n  );\n  const [sending, setSending] = useState(false);\n  const [message, setMessage] = useState(\"\");\n\n  // Call onScoresChange when initialScores or scores change\n  useEffect(() => {\n    if (initialScores) {\n      onScoresChange({ currentScores, projectedScores });\n    }\n  }, [initialScores, currentScores, projectedScores, onScoresChange]);\n\n  const handleScoreChange = (setter) => (e) => {\n    const { name, value } = e.target;\n    const val = Math.min(5, Math.max(0, parseInt(value) || 0));\n    setter((prev) => ({ ...prev, [name]: val }));\n  };\n\n  const handleSendScores = async () => {\n    setSending(true);\n    setMessage(\"\");\n\n    const isValidScore = (val) =>\n      typeof val === \"number\" && !isNaN(val) && val > 0 && val <= 5;\n\n    const allCurrentFilled = Object.values(currentScores).every(isValidScore);\n    const allProjectedFilled =\n      Object.values(projectedScores).every(isValidScore);\n\n    if (!allCurrentFilled || !allProjectedFilled) {\n      setMessage(\"âš ï¸ Please fill in all fields with scores between 1 and 5.\");\n      setSending(false);\n      return;\n    }\n\n    try {\n      const response = await axios.post(\n        \"http://localhost:4000/api/scores\",\n        { current: currentScores, projected: projectedScores },\n        { withCredentials: true }\n      );\n\n      if (response.status === 201) {\n        setMessage(\"âœ… Scores submitted successfully!\");\n        onScoresChange({ currentScores, projectedScores });\n      } else {\n        setMessage(\"âš ï¸ Something went wrong. Please try again.\");\n      }\n    } catch (error) {\n      console.error(\"Error submitting scores:\", error.response?.data);\n      const status = error.response?.status;\n\n      if (status === 409) {\n        setMessage(\"âœ… Scores already submitted. Displaying your chart...\");\n        onScoresChange({ currentScores, projectedScores });\n      } else {\n        setMessage(\n          status === 403\n            ? \"ðŸš« Session expired. Please log in again.\"\n            : \"âŒ Error submitting scores. Try again.\"\n        );\n\n        if (status === 403) {\n          window.location.href = \"/login\";\n        }\n      }\n    } finally {\n      setSending(false);\n    }\n  };\n\n  return (\n    <>\n      <InputForm\n        title=\"CURRENT STATE (JUNE 2025)\"\n        scores={currentScores}\n        onChange={handleScoreChange(setCurrentScores)}\n        categories={categories}\n      />\n      <InputForm\n        title=\"TARGET FOR 2027\"\n        scores={projectedScores}\n        onChange={handleScoreChange(setProjectedScores)}\n        categories={categories}\n      />\n      <div className=\"submit-section\">\n        <button\n          className=\"modern-button send-btn\"\n          onClick={handleSendScores}\n          disabled={sending}\n        >\n          {sending ? \"Sending...\" : \"Submit Assessment\"}\n        </button>\n        {message && <p className=\"status-message\">{message}</p>}\n      </div>\n    </>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}